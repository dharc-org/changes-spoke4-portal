{% extends 'base.html' %}

{% block title %}{{ collection.display_title or collection.header_title }}{% endblock %}

{% from 'macros/header_brand.html' import header_brand_collection %}
{% from 'macros/header_links.html' import header_collection_links %}
{% block header_brand %}
{{ header_brand_collection(collection.id, collection.image, collection.nav_title or collection.display_title) }}
{% endblock %}

{# Right-side header links for collection pages #}
{% block header_links %}
{{ header_collection_links(collection.id, '') }}
{% endblock %}

{% block content %}
<style>
    /* Page-scoped styles for the collection home */
    .collection-hero {
        padding: 15rem;
        background-color: var(--bs-dark);
        color: var(--color-secondary);
    }

    .btn-accent {
        --bs-btn-bg: var(--color-accent);
        --bs-btn-border-color: var(--color-accent);
        --bs-btn-hover-bg: #bc2787;
        /* slightly lighter */
        --bs-btn-hover-border-color: #bc2787;
        --bs-btn-color: var(--color-secondary);
    }

    .decor-circle {
        width: 84px;
        height: 84px;
        border-radius: 50%;
        background-color: var(--color-accent);
    }

    /* Description band carousel (cropped + overlay like homepage) */
    .band-carousel {
        width: 100%;
        max-width: 434px;
        aspect-ratio: 434 / 252;
        border-radius: .5rem;
        overflow: hidden;
        box-shadow: 0 .5rem 1rem rgba(0, 0, 0, .25);
    }

    .band-carousel .carousel-inner {
        height: 100%;
    }

    .band-carousel .carousel-item {
        height: 100%;
    }

    .band-carousel .carousel-item::after {
        content: '';
        position: absolute;
        inset: 0;
        background: var(--color-accent);
        opacity: .38;
        mix-blend-mode: multiply;
        pointer-events: none;
    }

    .carousel-item img {
        object-fit: cover;
        height: 100%;
    }

    .band {
        padding: 4rem 6rem;
        border-top: 1px solid var(--color-secondary);
        border-bottom: 1px solid var(--color-secondary);
        background-color: var(--bs-dark);
        color: var(--color-secondary);
    }

    .band h3 {
        color: var(--color-secondary);
    }

    .credits {
        padding: 5rem 2rem;
        border-bottom: 1px solid var(--color-secondary);
    }

    .credits .decor-circle {
        width: 72px;
        height: 72px;
    }
</style>

<!-- Hero -->
<section class="collection-hero text-center font-sans">
    <div class="container-xxl">
        <h3 class="mx-auto mb-4" style="max-width: 60ch;">{{ collection.header_title }}</h3>
        <p class="mx-auto mb-4" style="max-width: 56ch;">
            {{ collection.header_subtitle }}
        </p>
        <a href="{{ collection.catalogue_link }}" class="btn btn-accent btn-sm">
            {{ gettext('Esplora il catalogo') }}
        </a>
    </div>

</section>

<!-- Description band -->
<section class="band">
    <div class="container-xxl">
        <div class="row align-items-center justify-content-center gy-4">
            <div class="col-12 col-md-5 col-lg-5 d-flex justify-content-center justify-content-md-start">
                {% set _slides = collection.get('carousel_images') or ['img/01.png','img/02.jpg','img/03.jpg',
                'img/04.jpg'] %}
                <div id="descCarousel" class="carousel slide band-carousel" data-bs-interval="false"
                    data-bs-touch="false">
                    <div class="carousel-inner">
                        {% for img in _slides %}
                        <div class="carousel-item {{ 'active' if loop.index0 == 0 else '' }}">
                            <img src="{{ url_for('static', filename=img) }}" class="d-block w-100"
                                alt="Slide {{ loop.index }}">
                        </div>
                        {% endfor %}
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#descCarousel"
                        data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">{{ gettext('Precedente') }}</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#descCarousel"
                        data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">{{ gettext('Successivo') }}</span>
                    </button>
                </div>
            </div>
            <div class="col-12 col-md-7 col-lg-6">
                <h3 class="h4 mb-3">{{ collection.description_title }}</h3>
                {% for paragraph in collection.description_text %}
                <p class="mb-3 font-sans">{{ paragraph }}</p>
                {% endfor %}
                <a class="mt-4 d-inline-block font-sans link-on-dark" href="{{ collection.overview_link }}">
                    {{ gettext('Esplora i dettagli di progetto') }} â†’
                </a>
            </div>
        </div>
    </div>
</section>

{% endblock %}