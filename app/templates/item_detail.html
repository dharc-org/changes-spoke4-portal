{% extends "base.html" %}

{% block title %}{{ item.title or 'Item' }}{% endblock %}

{% block extra_head %}
<style>
  /* Hide global footer on item detail */
  footer {
    display: none !important;
  }
</style>
{% if item_api and item_api.style %}
<link rel="stylesheet" href="{{ item_api.style }}">
{% endif %}
{% endblock %}

{% from 'macros/header_brand.html' import header_brand_collection %}
{% block header_brand %}
{{ header_brand_collection(collection_meta.id, collection_meta.image, collection_meta.nav_title) }}
{% endblock %}

{% block content %}
<section class="container-fluid px-0 item-layout">
  <div class="row g-0 h-100">
    <!-- Sidebar (left, dark) -->
    <aside class="col-12 col-lg-4 bg-dark text-light border-end border-dark item-sidebar">
      <div class="px-3 py-2 border-bottom border-secondary d-flex align-items-center justify-content-between">
        <h1 class="h4 m-0">{{ item.title }}</h1>
        <a href="{{ url_for('main.catalogue', collection_id=collection_meta.id) }}"
          class="link-on-dark text-decoration-none small">&larr; {{ gettext('torna alla mostra') }}</a>
      </div>

      <!-- API-driven metadata sidebar content -->
      <div id="api-sidebar-content" class="item-sidebar-section px-3 py-3" data-api-url="{{ (item_api.url or '') }}"
        data-config-url="{{ (item_api.config_url or '') }}" data-item-uri="{{ item.id }}"
        data-lang="{{ get_locale() }}"></div>
    </aside>

    <!-- 3D viewer / media area (right) -->
    <section class="col-12 col-lg-8 item-viewer d-flex align-items-center justify-content-center">
      <div class="viewer-placeholder text-muted">{{ gettext('IMMAGINE OGGETTO (3D)') }}</div>
    </section>
  </div>
</section>
{% if item_api and item_api.script %}
<script>
  window.MELODY_CONFIG = {
    API_URL: {{ (item_api.url or '') | tojson }},
  CONFIG_URL: { { (item_api.config_url or '') | tojson } },
  ITEM_URI: { { item.id | tojson } },
  LANG: { { get_locale() | tojson } }
  };
</script>
<script src="{{ item_api.script }}" defer></script>
{% endif %}
{% endblock %}